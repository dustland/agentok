# configs.j2

{%- macro generate_configs(project) %}
config_list = autogen.config_list_from_json(
    "OAI_CONFIG_LIST",
    {%- if project['settings'].filter_dict %}
    filter_dict={
        "model": {{ project['settings'].filter_dict.split(',') }},
    },
    {%- endif %}
)

llm_config = {
    {%- if skills %}
    "functions": [
        {%- for skill in skills %}
        {
            "name": "{{ skill.name }}",
            "description": "{{ skill.description }}",
            "parameters": {
                "type": "object",
                "properties": {
                    {%- for param in skill.parameters %}
                    "{{ param.name }}": {
                        "type": "{{ param.type }}",
                        "description": "{{ param.description }}"
                    }{% if not loop.last %},{% endif %}
                    {%- endfor %}
                },
                "required": [
                  {%- for param in skill.parameters %}
                  {%- if param.required %}
                  "{{ param.name }}" {% if not loop.last %}, {% endif %}
                  {%- endif %}
                  {%- endfor %}
                ]
            }
        }{% if not loop.last %},{% endif %}
        {%- endfor %}
    ],
    {%- endif %}
    "config_list": config_list,
    {%- if project['settings'] is not none and project['settings'].get('timeout') is not none %}
    "timeout": {{ project['settings'].timeout }},
    {%- endif %}
    {%- if project['settings'] is not none and project['settings'].get('temperature') is not none %}
    "temperature": {{ project['settings'].get('temperature') }},
    {%- endif %}
    {%- if project['settings'] is not none and project['settings'].get('max_tokens') is not none %}
    "max_tokens": {{ project['settings'].get('max_tokens') }},
    {%- endif %}
}

{%- if group_chat_node %}
group_llm_config={
    "config_list": config_list,
    {%- if project['settings'] is not none and project['settings'].get('timeout') is not none %}
    "timeout": {{ project['settings'].timeout }},
    {%- endif %}
    {%- if project['settings'] is not none and project['settings'].get('temperature') is not none %}
    "temperature": {{ project['settings'].get('temperature') }},
    {%- endif %}
    {%- if project['settings'] is not none and project['settings'].get('max_tokens') is not none %}
    "max_tokens": {{ project['settings'].get('max_tokens') }},
    {%- endif %}
}
{%- endif %}

{%- endmacro %}
